<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Consulta Recibo Sonrisas</title>
<style>
body {font-family: Arial, sans-serif; background:#f4f6f9; margin:0; padding:20px;}
.container {max-width:1100px; margin:auto;}
h2 {text-align:center;}
.search-box {margin:20px 0;}
input {width:100%; padding:12px; font-size:16px; border-radius:8px; border:1px solid #ccc;}
table {width:100%; border-collapse:collapse; margin-top:20px; display:none; background:white; border-radius:10px; overflow:hidden;}
th, td {padding:12px; text-align:left; border-bottom:1px solid #eee; font-size:14px;}
th {background:#f8f9fa;}
tr:hover {background:#f1f1f1;}
.badge {padding:5px 10px; border-radius:12px; font-size:12px; color:white;}
.estado-cargadas {background:#28a745;}
.no-results {margin-top:20px; text-align:center; display:none;}
</style>
</head>
<body>
<div class="container">
<h2>ðŸ”Ž Consulta Recibo Sonrisas</h2>

<div class="search-box">
<input type="text" id="searchInput" placeholder="Escribe el nombre...">
</div>

<table id="resultsTable">
<thead>
<tr>
<th>Fecha</th>
<th>Emisor</th>
<th>Receptor</th>
<th>Concepto</th>
<th>Valor</th>
<th>Estado</th>
</tr>
</thead>
<tbody></tbody>
</table>

<div class="no-results" id="noResults">No se encontraron resultados.</div>
</div>

<script>
let data = [];

fetch("data.json?v=" + new Date().getTime())
  .then(response => response.json())
  .then(json => data = json);

const input = document.getElementById("searchInput");
const table = document.getElementById("resultsTable");
const tbody = table.querySelector("tbody");
const noResults = document.getElementById("noResults");

input.addEventListener("keyup", function() {
    const filter = input.value.toLowerCase();
    tbody.innerHTML = "";
    
    if (filter.length < 2) {
        table.style.display = "none";
        noResults.style.display = "none";
        return;
    }

    const filtered = data.filter(row => 
        row.emisor.toLowerCase().includes(filter) || 
        row.receptor.toLowerCase().includes(filter)
    );

    if (filtered.length === 0) {
        table.style.display = "none";
        noResults.style.display = "block";
        return;
    }

    noResults.style.display = "none";
    table.style.display = "table";

    filtered.forEach(row => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
            <td>${row.fecha}</td>
            <td>${row.emisor}</td>
            <td>${row.receptor}</td>
            <td>${row.concepto}</td>
            <td>${row.valor}</td>
            <td><span class="badge estado-cargadas">${row.estado}</span></td>
        `;
        tbody.appendChild(tr);
    });
});
</script>

</body>
</html>
